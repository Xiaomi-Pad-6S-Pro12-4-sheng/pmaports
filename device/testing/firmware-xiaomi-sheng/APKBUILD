# Maintainer: alghiffaryfa19 <alghiffaryfa19@gmail.com>
pkgname=firmware-xiaomi-sheng
pkgver=20240917
pkgrel=1
pkgdesc="Firmware for Xiaomi Mi Pad 6s Pro"
url="https://github.com/map220v/sheng-firmware"
arch="aarch64"
license="proprietary"
options="!check !strip !archcheck !tracedeps pmb:cross-native"
_commit="92c49abb2da9f325e8385ca6f0ad1fb39608af7b"
source="
	$pkgname-$_commit.tar.gz::https://github.com/map220v/sheng-firmware/archive/$_commit.tar.gz
	30-gpu-firmware.files
"
depends="
	linux-firmware-ath12k
	linux-firmware-qcom
	linux-firmware-qca
	"
builddir="$srcdir/sheng-firmware-$_commit"

package() {
	# parent package is empty
	# mkdir -p "$pkgdir/lib/firmware"
	# cp -r "$builddir"/* "$pkgdir/lib/firmware/"

	install -Dm644 "$builddir"/ath12k/WCN7850/hw2.0/* -t \
		"$pkgdir"/lib/firmware/ath12k/WCN7850/hw2.0/
	
	install -Dm644 "$builddir"/nanosic/* -t \
		"$pkgdir"/lib/firmware/nanosic/

	install -Dm644 "$builddir"/novatek/* -t \
		"$pkgdir"/lib/firmware/novatek/

	install -Dm644 "$builddir"/qca/* -t \
		"$pkgdir"/lib/firmware/qca/

	install -Dm644 "$builddir"/qcom/a740_sqe.fw -t \
		"$pkgdir"/lib/firmware/qcom/
	
	install -Dm644 "$builddir"/qcom/gmu_gen70200.bin -t \
		"$pkgdir"/lib/firmware/qcom/

	install -Dm644 "$builddir"/qcom/sm8550/Xiaomi-Pad6SPro-tplg.bin -t \
		"$pkgdir"/lib/firmware/qcom/sm8550/

	install -Dm644 "$builddir"/qcom/sm8550/sheng/* -t \
		"$pkgdir"/lib/firmware/qcom/sm8550/sheng/

	install -Dm644 "$srcdir"/30-gpu-firmware.files \
		"$subpkgdir"/usr/share/mkinitfs/files/30-gpu-firmware.files
}
